<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="../favicon.ico" />
        <title>px-simple-line-chart Demo</title>
        <!-- Requires Webcomponents.js polyfill is provided by the page for browsers that don't support html imports -->
        <script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
        <script src="../web-component-tester/browser.js"></script>
        <script src="../demo-data/sample-data.js"></script>
        <script src="px-test-helpers.js"></script>
        <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->
        <link rel="import" href="../px-simple-line-chart.html" />
    </head>
    <body>

        <px-simple-line-chart id="fixture"></px-simple-line-chart>

        <div style="width:320px; height:100px;">
            <div>
                <div>
                    <px-simple-line-chart id="fixture1" width="auto" height="auto"></px-simple-line-chart>
                </div>
            </div>
        </div>

        <script>

            var fixture, div, svg, boundingBox;



            describe('default <px-simple-line-chart> basic features', function() {

                before(function(done) {
                    var svgIsReady = function() {
                        fixture = document.getElementById('fixture');
                        if(fixture) {
                            div = fixture.querySelector('div');
                            if(div) {
                                svg = div.children[0];
                                if(svg.tagName.toLowerCase() === 'svg') {
                                    return true;
                                } else {
                                    return false;
                                };
                            } else {
                                return false;
                            };
                        } else {
                            return false;
                        };
                    };
                    var chartIsDrawn = function() {
                        waitFor(done, function(){
                            boundingBox = svg.getBoundingClientRect();
                            if(svg.offsetHeight > 0) {
                                return true;
                            } else {
                                return false;
                            }
                        });
                    };
                    waitFor(chartIsDrawn, svgIsReady)
                });

                it('fixture exists', function(done) {
                    assert.isTrue(fixture !== null);
                    done();
                });
                it('SVG element exists', function(done) {
                    assert.isTrue(svg.tagName.toLowerCase() === 'svg');
                    done();
                });
                it('SVG element has height greater than zero', function(done) {
                    assert.isTrue(boundingBox.height > 0)
                    done();
                });
                it('SVG element has default height', function(done) {
                var box = svg.getBoundingClientRect();
                    assert.isTrue(boundingBox.height === 150);
                    done();
                });
                it('SVG element has width greater than zero', function(done) {
                 var box = svg.getBoundingClientRect();
                    assert.isTrue(boundingBox.width > 0);
                    done();
                });
                it('SVG element has default width', function(done) {
                    var width = svg.offsetWidth;
                     var box = svg.getBoundingClientRect();

                    assert.isTrue(boundingBox.width === 283 || boundingBox.width ===300);
                    done();
                });
            });

            describe('default <px-simple-line-chart> basic features', function() {

                before(function(done) {
                    var svgIsReady = function() {
                        fixture = document.getElementById('fixture1');
                        if(fixture) {
                            div = fixture.querySelector('div');
                            if(div) {
                                svg = div.children[0];
                                if(svg.tagName.toLowerCase() === 'svg') {
                                    return true;
                                } else {
                                    return false;
                                };
                            } else {
                                return false;
                            };
                        } else {
                            return false;
                        };
                    };
                    var chartIsDrawn = function() {
                        waitFor(done, function(){
                            boundingBox = svg.getBoundingClientRect();
                            if(svg.offsetHeight > 0) {
                                return true;
                            } else {
                                return false;
                            }
                        });
                    };
                    waitFor(chartIsDrawn, svgIsReady)
                });

                it('fixture exists', function(done) {
                    assert.isTrue(fixture !== null);
                    done();
                });
                it('SVG element exists', function(done) {
                    assert.isTrue(svg.tagName.toLowerCase() === 'svg');
                    done();
                });
                it('SVG element has height greater than zero', function(done) {
                    assert.isTrue(boundingBox.height > 0)
                    done();
                });
                it('SVG element has default height', function(done) {
                    setTimeout(function(){
                    var box = svg.getBoundingClientRect();
                    console.log("boundingBox.height", boundingBox.height);
                    assert.isTrue(boundingBox.height === 100);
                    done();
                    }, 3000);
                });
                it('SVG element has width greater than zero', function(done) {
                    var box = svg.getBoundingClientRect();
                    assert.isTrue(boundingBox.width > 0);
                    done();
                });
                it('SVG element has default width', function(done) {
                    setTimeout(function(){
                        var width = svg.offsetWidth;
                    var box = svg.getBoundingClientRect();
                    console.log("boundingBox.width", boundingBox.width);
                    assert.isTrue(boundingBox.width === 337 || boundingBox.width ===320);
                    done();
                    }, 3000);
                });
            });
        </script>

    </body>
</html>
